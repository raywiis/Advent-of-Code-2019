

fn main() {
    let input = "22222222222222212022222222021222222202222222222222222222122221222202222201220202202221222212220222222222220002222022222220220212221222212212222222222221222222222222212122222022220222222222222222222222222222122221222212222200221202202220222212222221222222220112222122222221220222222222202202222222222221222222222222222022222122220222222222222222222222222222022221222222222221220202202221222212220221222222220002222022222221222202221222202222222222222222222222222222222022222122120222222222222222222222222222022221222222222202221212212221222222222220222222222202222022222220220222222222202212222222222221222222222222202122222122220222222222222222222222222222222222222212222210221212202220222212220221222222220022222222222220220222221222222212222222222221222222222222202222222222021222222222222222222222222221120221220212122202221022212222222202222222222222221122222022222222220212220222202222222222222222222222222222202222222022120222222212222222222222222222222222222212022212221212202220222222221220222222221112222122222220221212220222012202222222222222222222222222222022222222221222222212222222222222222200121221221202222212222022222220222222222221222222222022222122222220221222221222022212222222222220222222222222212022222022221222222212222222222222222212121222220222122211222022212221222202220221222222220112222022222221220212222222022212222222222221222222222222202122222022122222222222222222222222222212020222220212222222221012222220222202220222222222222202222122222222220212220222202212222222222221222222222222202122222022222222222202222222222222222211222220222202222201220112222222222212221220222022222022222222222222222202221222202212222222222220222222222222222222222002220222222212222222222222222212122221222222022212222122202221222212221220222122210002222122222220220222222222202222222222222222222222222222222122222202221222022212222222222220222210221220220222222211222112222222222222220220222122202202222122222020222212221222022222222222222221222222222222212222222222221222122202222222222222222221220221220202222211221012222221222222222220222122211212222022222022220212220222012012222222222201222222222222212022222222022222122222222222222220222211122220222212022200220022202220222222222221222222200022222122222022221212221222112102222222222210222222222222202122222222222222022212222222222220222211222220221202122200220202202221222222222221221022201202222122222220222211220222202222222222222222222222222222202122222002122222122202222222222221222222122222220212122211221012212201222222222220221222212022222122222222222200221222222022222222222210222212222222202122222102022222122212222222222221222221021221222202122202221222212220222222221221222022201122222122222221220201220222112012222222222220222202222222202222222212122222222202222222222220222221221222220222022220220022222212222212221222222122200112222122222120221212220222112112222222222210222212222222212122222102021222022202022222222022222212222220220\
        222022201221012212202222202222222220222220222222022222120220221221222212022222222222201222202222222222122212022120222122202122222222020222210222222221202222212220222212212222202221222222222202002222122222122220222220222112020222222222212222212222222212122202202020222022222122222222022222221022220222212122200221002212211222212221221221222200022222222222122220200222222212110222222222210222212222222212222212222221222122202122222222022222210121220220222122201221102212200222202222220222122212022222222222220221200220222212202222222222202222202222222212022212222121222122212022022222120222222222220221202222211221102202200222222220220220122202212222222222022220200220222022220222222222200222212222222202222222002122222122212122122222221222221220221222222122200222002202221222222221221222022211212222122222221220222220222222012222222222212222202222222222022212002120222222202022222222022222221022220220212022222221212212202222202220222220022211022222222222220220201220222112111222222222222222222222222202022212002021222222222122222222222222220021221222212022222221122212200222202222222221122221212222122222120221222220222002102222222222210222212222222212222212112021222122222022222220221222201121221220222122220221012212221222202220220222122212112222222222121222212221222222211222222222201122222222202222122222212221222022202022122221020222210121220201212022201220212202220222212220220221022212022222222222020222220222222112001222222222201222202222202212022212212220222122212221222221220222220020222222202122220221112202222222222220220221022210102222222222222220202222222022101222222222201222202222212002222212022222222222202220222220120222220220222221212122212221002212201222212222220221122202122222102222122222210222222122011222222222202022222222212112122222002221222222212222022220021222221222220200222101201020002222212222202222222220122201022222002222222222210222222112202222222222212122212222212002022202202020222122202120122222122122210120221210202202010021202212212222202222222222222201112222102222220222202222222022212222222222211022202222202122222222002222222122222022022221221022220222221211222001010022122202202222202222221220222211202222122222220222220221222012012222221202210222202222222022122222022222222122202121222221021222201220221210222210012021222202211222202222221220022212102222002222021220210220222012220222220222222222222222202022122222112022222122222120222222222022201220221201212102001220212212201222212221220222122220122222102222020222210220222102101222220212221122212222212112022212112121222122212121222222220022220220220212202011022220122202201212202220220222122202012222002222121221200222222122220222220212220122212222212112022212222122222022202021122220021122201221221220202111222020122202211202222222222221022222202222012222021222212220222022211222222202202022222222202102122222212121222022222021222221220122212221222212222010202222112202222212212221220221022211012222212222022222201220222102101222\
        220222221222212222212102222212022221222122202021022221020222200121221201200020010120122212212222212222222221222210122222212221021222222220222212101222222222212122222221212112222202012221222022222221022222020022222122220210222221100120212202201212202220222220022212122222022220220220200222222122122222220222202022222221202222222202002120222122222221222222220122222221221200201011100222122222211222222220221220222211122222222220121220200221222202220222222222211222222220212002122212022020222022212220222222222122220221220211222202111022002212212212212222222220222222102222112221222221201220222002112222221222202122222221212012122222222122222222222020122221120022210221222210212101010021222202211212222220220220022201122222002221120222202220222222220222222212200122222222202222222202122122222022202121122221220022210021221202210122102021222212202202222221222220222221122222002220222220221220222122100222220212222022202221222212022202212220222022202021222222122022202021221220211210102020002222210222212220220221002211202222002220020222202221222022121222220222200122212220212212022202112120222020222220222220222022221122221220212012021120122202220212222221220220102211202222112222120222221221222222210222220222221122202222012222022202202120222121222222222222221022212222222202212200121122212202201212212220220221212220000222002221121222201221222102021222222222212122222220022002022212012020222020212021022222222222210122220200210120002222222222201212202222222221112220120222122221021220221220222112002022222212201222222222002212222212022220222020222220122222022122222022221221211000011020002212221202212221220222012202120222102222122222202220222002020022220222222122202221222202122222022221222121222120122220022222221020221211221202220021022202200202202221222220002222221222022222220222220220222122100222001212210222212221112020022202022120222022222222022221122222200221220210211211210220222222200202202222222220202220120222122220122221210222222122000222011202202222202220112000222212222022222222202201222221120222222022221220220210211020122202210202202211222220102221122222112220021220202222222212122222122212202022222222212210222202212122222022212000222220222022211220222202211001212120212212220212222211221221102220112222012222220021211222221202220122110222221222212221222122222202112022222222222120122222222020222020221212212220012021112222212222222211221222102202012222012220020022200222220222002022011212200122222222002221122212202000222020202012122221222120211220221222202200110022012212212222202222221222222202112222112222022120211221220102201222210222201022222221012001222212212221222121212110222221120221210020221211210120222122112222220212212201221221102200220222222220020220221220222222202022202222202222222222112112122202002101222221212222122222221120220021220200211201020220012222201202222220220220002212221222122221211122212220221202021122202202212222212222212201222212112120222122202001122220221121220021220202222011\
        202021012202212212212220220222222202002222112220022021222221220212202121202202202122212221012022222222212211222020202011222222120220220222220210212021212121202222222212202210220222002222012222022222212222210222221222010222010202222222222221022220222202012110222022222200022222220121221022222220201201201120112212222202222210221221122200202222102221121021220222220122220020000201201122222220212112122202022100222221212122022222220022211022220200210102112222102222210222222222220220122202022222222220021021212221222012001020011222202222202220102012122202222100222220202212022220120122201021222200222011210021102212211202212200222220122211210222102220220221220221221222021120010221201122212221112222122212202112222020212122122220122221202122220220202220120221012222221202202211221222222210012222122222200221202222220012102220222211212122202221122212122222202002222220202022222220122120201020222201221000102022212202201202202202220222002210011222202220022121202202221110222020221210201022222222212220022222102211222221202212222220020022210122221200221121000021122222220202212202211220112211021222202221120120211222221020120220202221202222202221202122122202112110222021212221222221021122221222220222221020111221110212201222222200221222002202111222102221010022211221222000111121110211221222222221102010022222022000222221222210122221022120202221221211221200002221210202200202202220220221112210000222202020121121202220221222211020002201221022102222102112022212022021212022212210222222222020210222221201210112112020200202212222222222200202102201011222112021212220201212221100201021201211212122021222102002022212002212212220202200022220020120220221220212220122222121102222210212212201222201102201210222002122102221211210220022221020212220221222101222221102222202012020202122222111222221022120222221221201201212121120220222212202212210222202002222012222122021112222201202220202101220101201212222102222010210122001202100212121202122222221021221210221221200201211110121220222212212212221220221112222100222202020012121211222222000012221101222222222002220112100122020122020212020202100222222022021212012220222220120202021000212222212212222201222122211021222102021010022201200221102022222122212200122110222210002122200222022212222222210022220121220200220222211211021120022022212201222222200211212212202111222202121002222212211221020021121001220202122101121011121022211202020202220212010022221121222222221222210220002011121110212211212202222202210102200100222222220222122202222221012011221100221221022210020010122222221222201222022212100222221020020202211220221221201112020002202211202012202200212112210020222012122111022220202222020121221010221220022012121211210022211022101222222212100122222122120212220220201220012201122202222200222012221201211022222022122202101200022222212222210121112222211221022220220002100122121002000212121202210222222221121221221221212200012220022211212212222012220201222122200202022012010212121221210222002112202222202\
        201022221120000011122100012001212021222211022222122120011022222212212002210222100222202222222200200201012221020222212000110121212210220021022202221200201022222222011112222200212011202021222220022020020022210101221202211022120221012222222222112221221221102201012222222020201220200220220110222211022201212122222021112021222221102101212220202012122121220220112002021201221020100211011202212212002222221220022201212022022200010222220201221121111220101011201222100221002201222102212012202020202012222020221021111100120210201210020011000202200202102221220221002220022122212000011220202200221200212101012020211122110221200020022202122211212122222222122220120120112120121200200122112220101212211222202222221212212212101222212201111020202201221220100121010020202222222121022102022211012101212122212010022020222120111201122201201202121022012222202202112221200220012220212222212000100021212220222011020110002201222222220121122211022211002121212020212122022222221121122002121220201001001001110202200222022201211202012210121222112120111120211222220120122210100002211122010121111020222102112010202120202202122221020222012021222211212020211100002202220222022210212210012201112222012220210022201200221101222222200201222222101220120121222222112222212221202201002022221121201110221200220010021100211202221212012212222220202211021222102212022122200221221212110200200112202222112222111020122012022010202220212212202121022022220211222221210121111200000202202202012202211211222001221222122110120020220210220101222221110210202222110020110120022221112022202121202201002221221020011112021221212101100010112202210212112202210210022222111022112002122022212222220101120211001111222022221220000200222112202222202120212112212121021222021200021212201022121012020202222202102222201200012021222022202112012222020220222121022110122101222202020120000201020120122201212021202100022122122122220101022201211120020222101212211222022202201222012211212222202100110222001201221222111000002001201012000221021201122210012202212020212122122220120120220200222222222221111020120212221212102201201112222212100022012200010220002202221000112221222120220122010120100212120021002202222120212020212121221221201011020202222212021121112202201212212211221201022201022022022010210022020211222212010001120020211012022120021001120020202202202222222200122220021022211011022221202012200200022222221202012220212211212101100022202110120222122221222211010022112010201022002020211110022221202201202222222021122220222221000201022200220122211010202202211222002000200112122220021122222010110020110222222201120100122100222012022021211211021110102200212022202120012221120222202122221200201120101121202122211202102221120210012021020022102220021221110210221221112220202100202022100122202221222021002100222020202201221122222122000112020221220120221000020122221202222202120211212001221222012000011021001210221111120010001001201022122222212122020211022210212021212001110220020220220222211221220110020102\
        2201222102022220121020202021211001222120122102201102202212000202021101112202020200222221122202210122002022212112102202220212222121200002202202001211222012122012120221112121222022211210221121212200110122102220202111010220010201001201001100010120201012120201021020111021100120000200112010211101122001102102200110200200000121122212011022011112021022122210001101000112120101202";

    let width = 25;
    let height = 6;

    let mut pixel_count = 0;
    let mut layer_count = 0;
    let mut layers: Vec<Vec<u32>> = vec!();
    for c in input.chars() {
        if pixel_count == 0 {
            layers.push(Vec::new());
            layer_count += 1;
        }
        let layer = layers.last_mut().unwrap();
        layer.push(c.to_digit(10).expect("Not a number"));

        pixel_count += 1;
        pixel_count %= (width * height);
    }

    let mut min_0s = 10000;
    let mut min_0_idx = 0;

    for i in 0..layers.len() {
        let zero_count = layers[i].iter().filter(|x| **x == 0).count();

        if zero_count < min_0s {
            min_0s = zero_count;
            min_0_idx = i;
        }
    }

    let min_0_layer = &layers[min_0_idx];
    let count_2s = &min_0_layer.iter().filter(|x| **x == 2).count();
    let count_1s = &min_0_layer.iter().filter(|x| **x == 1).count();

    println!("result, {}", count_1s * count_2s);

    let image = render_image(layers);
    print_image(image, width);
}

fn render_image(layers: Vec<Vec<u32>>) -> Vec<u32> {
    let mut image: Vec<u32> = vec!();

    for _i in 0..layers[0].len() {
        image.push(2);
    }

    for layer in layers {
        for i in 0..layer.len() {
            if image[i] != 2 {
                continue;
            } else {
                image[i] = layer[i];
            }
        }
    }

    image
}

fn print_image(image: Vec<u32>, width: i32) {
    for i in 0..image.len() {
        if i % (width as usize) == 0 {
            print!("\n");
        }
        match image[i] {
            0 => print!(" "),
            1 => print!("#"),
            _ => panic!("Unexpected pixel value")
        }
    }
    print!("\n");
}
